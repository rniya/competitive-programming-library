---
title: binomial
documentation_of: ./binomial.hpp
---

## 概要
$\mathbb{Z}/p\mathbb{Z}$ における二項係数を扱うライブラリ. $n$ の上限等を指定する必要はなく, 不十分な場合に適宜上限を 2 倍にしていくことで効率的に計算する. 上限 $n$ , クエリ数 $q$ の際の時間計算量は $O(q + n + \log n\log p)$ となる.

下記の時間計算量については構築にかかる時間計算量は含んでいない.

| メンバ関数      | 効果                                                                                                                           | 時間計算量          |
| --------------- | ------------------------------------------------------------------------------------------------------------------------------ | ------------------- |
| `fac(i)`        | $i!$ を返す.                                                                                                                   | $O(1)$              |
| `finv(i)`       | $\frac{1}{i!}$ を返す.                                                                                                         | $O(1)$              |
| `inv(i)`        | $\frac{1}{i}$ を返す.                                                                                                          | $O(1)$              |
| `P(n, r)`       | ${}_n\mathrm{P}_r = \frac{n!}{r!}$ を返す.                                                                                     | $O(1)$              |
| `C(n, r)`       | ${}_n \mathrm{C}_r = \binom{n}{r} = \frac{n!}{(n - r)!r!}$ を返す.                                                             | $O(1)$              |
| `H(n, r)`       | ${}_n \mathrm{H}_r = \binom{n + r - 1}{r}$ , すなわち $n$ 種類のものから重複を許して $r$ 個取り出す組み合わせの総数を計算する. | $O(1)$              |
| `C_naive(n, r)` | $\binom{n}{r}$ を愚直に計算する.                                                                                               | $O(\min(r, n - r))$ |
