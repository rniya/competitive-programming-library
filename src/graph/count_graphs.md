---
title: Enuemrate $C_3$, Count $C_4, K_4$
documentation_of: ./count_graphs.hpp
---

## 概要

$n$ 頂点 $m$ 辺の無向グラフ $G$ に含まれる $C_3$ の列挙及び $C_4, K_4$ の数え上げを以下に述べる時間計算量で行う．

基本的には各辺を次数の小さい頂点から大きい頂点に向き付けた有向グラフ $H$ を考えることにする．
このとき，各頂点の次数は $\sqrt{2 m}$ で抑えることができる．

#### $C_3$

$H$ 上で $a$ から辺が出ている点 $b$，$b$ から辺が出ている点 $c$ を走査する．
$1$ 本目の辺が $m$ 本で，$2$ 本目の辺がそれぞれ $\mathrm{O}(\sqrt{m})$ 本だから全体で $\mathrm{O}(m\sqrt{m})$ 時間で計算可能である．

#### $C_4$

$4$ 頂点のうち次数が最大の点 $c$ の対角にある頂点 $a$ を固定する．
$1, 2$ 本目の辺をそれぞれ $G, H$ 上にとるような $a$ から $c$ への長さ $2$ のパスを $2$ つ選ぶ選び方を合計すれば良い．

計算量は $\mathrm{O}(m \sqrt{m})$．

#### $K_4$

$K_4$ に含まれる頂点のうち最も小さい頂点 $a$ を固定する．
$a, b, c, d$ が $K_4$ を成すのは $H$ 上で $a$ から $b, c, d$ に辺が張られており，かつ $b, c, d$ が $G$ 上で $C_3$ を成すのと同値であるから，$a$ の $H$ での隣接点からなる誘導部分グラフの中で $C_3$ を数えればよい．

計算量はワードサイズを $w$ として $\mathrm{O}\left(m \sqrt{m} + \frac{m^2}{w}\right)$．

## Links
- [ecnerwala のコメント](https://codeforces.com/blog/entry/97762#comment-866645)

## 問題例
- [The 1st Universal Cup. Stage 13: Iberia K. 4](https://qoj.ac/problem/6354)